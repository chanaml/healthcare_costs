{"version":3,"file":"ColorScale.js","sources":["../../src/ColorScale.js"],"sourcesContent":["/**\n    @external BaseClass\n    @see https://github.com/d3plus/d3plus-common#BaseClass\n*/\n\nimport ckmeans from \"./ckmeans\";\n\nimport {extent, merge, range} from \"d3-array\";\nimport {interpolateHsl} from \"d3-interpolate\";\nimport {scaleLinear, scaleThreshold} from \"d3-scale\";\nimport {select} from \"d3-selection\";\n\nimport {Axis} from \"d3plus-axis\";\nimport {colorLighter} from \"d3plus-color\";\nimport {accessor, BaseClass, constant, elem} from \"d3plus-common\";\nimport {Rect} from \"d3plus-shape\";\n\n/**\n    @class ColorScale\n    @extends external:BaseClass\n    @desc Creates an SVG scale based on an array of data. If *data* is specified, immediately draws based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#shape.data) method.\n*/\nexport default class ColorScale extends BaseClass {\n\n  /**\n      @memberof ColorScale\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n\n    super();\n\n    this._axisClass = new Axis();\n    this._axisConfig = {\n      gridSize: 0\n    };\n    this._axisTest = new Axis();\n    this._align = \"middle\";\n    this._color = \"#0C8040\";\n    this._data = [];\n    this._duration = 600;\n    this._height = 200;\n    this._orient = \"bottom\";\n    this._outerBounds = {width: 0, height: 0, x: 0, y: 0};\n    this._padding = 5;\n    this._rectClass = new Rect();\n    this._rectConfig = {\n      stroke: \"#000\",\n      strokeWidth: 1\n    };\n    this._scale = \"linear\";\n    this._size = 10;\n    this._value = accessor(\"value\");\n    this._width = 400;\n\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Renders the current ColorScale to the page. If a *callback* is specified, it will be called once the ColorScale is done drawing.\n      @param {Function} [*callback* = undefined]\n      @chainable\n  */\n  render(callback) {\n\n    if (this._select === void 0) this.select(select(\"body\").append(\"svg\").attr(\"width\", `${this._width}px`).attr(\"height\", `${this._height}px`).node());\n\n    const horizontal = [\"bottom\", \"top\"].includes(this._orient);\n\n    const height = horizontal ? \"height\" : \"width\",\n          width = horizontal ? \"width\" : \"height\",\n          x = horizontal ? \"x\" : \"y\",\n          y = horizontal ? \"y\" : \"x\";\n\n    // Shape <g> Group\n    this._group = elem(\"g.d3plus-ColorScale\", {parent: this._select});\n\n    const domain = extent(this._data, this._value);\n    let colors = this._color, ticks;\n\n    if (!(colors instanceof Array)) {\n      colors = [\n        colorLighter(colors, 0.9),\n        colorLighter(colors, 0.75),\n        colorLighter(colors, 0.5),\n        colorLighter(colors, 0.25),\n        colors\n      ];\n    }\n\n    if (this._scale === \"jenks\") {\n\n      const data = this._data\n        .map(this._value)\n        .filter(d => d !== null && typeof d === \"number\");\n\n      if (data.length <= colors.length) {\n\n        const ts = scaleLinear()\n          .domain(range(0, data.length - 1))\n          .interpolate(interpolateHsl)\n          .range(colors);\n\n        colors = data.slice(0, data.length - 1).map((d, i) => ts(i));\n      }\n\n      const jenks = ckmeans(data, colors.length);\n\n      ticks = merge(jenks.map((c, i) => i === jenks.length - 1 ? [c[0], c[c.length - 1]] : [c[0]]));\n\n      this._colorScale = scaleThreshold()\n        .domain(ticks)\n        .range([\"black\"].concat(colors).concat(colors[colors.length - 1]));\n\n    }\n    else {\n\n      const step = (domain[1] - domain[0]) / (colors.length - 1);\n      const buckets = range(domain[0], domain[1] + step / 2, step);\n\n      if (this._scale === \"buckets\") ticks = buckets;\n\n      this._colorScale = scaleLinear()\n        .domain(buckets)\n        .range(colors);\n\n    }\n\n    const axisConfig = Object.assign({\n      domain: horizontal ? domain : domain.reverse(),\n      duration: this._duration,\n      height: this._height,\n      labels: ticks,\n      orient: this._orient,\n      padding: this._padding,\n      ticks,\n      width: this._width\n    }, this._axisConfig);\n\n    this._axisTest\n      .select(elem(\"g.d3plus-ColorScale-axisTest\", {enter: {opacity: 0}, parent: this._group}).node())\n      .config(axisConfig)\n      .render();\n\n    const axisBounds = this._axisTest.outerBounds();\n\n    this._outerBounds[width] = this[`_${width}`] - this._padding * 2;\n    this._outerBounds[height] = axisBounds[height] + this._size;\n\n    this._outerBounds[x] = this._padding;\n    this._outerBounds[y] = this._padding;\n    if (this._align === \"middle\") this._outerBounds[y] = (this[`_${height}`] - this._outerBounds[height]) / 2;\n    else if (this._align === \"end\") this._outerBounds[y] = this[`_${height}`] - this._padding - this._outerBounds[height];\n\n    const groupOffset = this._outerBounds[y] + ([\"bottom\", \"right\"].includes(this._orient) ? this._size : 0) - (axisConfig.padding || this._axisClass.padding());\n    this._axisClass\n      .select(elem(\"g.d3plus-ColorScale-axis\", {\n        parent: this._group,\n        update: {transform: `translate(${horizontal ? 0 : groupOffset}, ${horizontal ? groupOffset : 0})`}\n      }).node())\n      .config(axisConfig)\n      .align(\"start\")\n      .render();\n\n    const axisScale = this._axisTest._getPosition.bind(this._axisTest);\n    const scaleRange = this._axisTest._getRange();\n\n    let defs = this._group.selectAll(\"defs\").data([0]);\n    const defsEnter = defs.enter().append(\"defs\");\n    defsEnter.append(\"linearGradient\").attr(\"id\", `gradient-${this._uuid}`);\n    defs = defsEnter.merge(defs);\n    defs.select(\"linearGradient\")\n      .attr(`${x}1`, horizontal ? \"0%\" : \"100%\")\n      .attr(`${x}2`, horizontal ? \"100%\" : \"0%\")\n      .attr(`${y}1`, \"0%\")\n      .attr(`${y}2`, \"0%\");\n    const stops = defs.select(\"linearGradient\").selectAll(\"stop\")\n      .data(colors);\n    stops.enter().append(\"stop\").merge(stops)\n      .attr(\"offset\", (d, i) => `${i / (colors.length - 1) * 100}%`)\n      .attr(\"stop-color\", String);\n\n    function bucketWidth(d, i) {\n      const w = Math.abs(axisScale(ticks[i + 1]) - axisScale(d));\n      return w || 2;\n    }\n\n    this._rectClass\n      .data(ticks ? ticks.slice(0, ticks.length - 1) : [0])\n      .id((d, i) => i)\n      .select(elem(\"g.d3plus-ColorScale-Rect\", {parent: this._group}).node())\n      .config({\n        fill: ticks ? d => this._colorScale(d) : `url(#gradient-${this._uuid})`,\n        [x]: ticks ? (d, i) => axisScale(d) + bucketWidth(d, i) / 2 - ([\"left\", \"right\"].includes(this._orient) ? bucketWidth(d, i) : 0) : scaleRange[0] + (scaleRange[1] - scaleRange[0]) / 2,\n        [y]: this._outerBounds[y] + ([\"top\", \"left\"].includes(this._orient) ? axisBounds[height] : 0) + this._size / 2,\n        [width]: ticks ? bucketWidth : scaleRange[1] - scaleRange[0],\n        [height]: this._size\n      })\n      .config(this._rectConfig)\n      .render();\n\n    if (callback) setTimeout(callback, this._duration + 100);\n\n    return this;\n\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Axis](http://d3plus.org/docs/#Axis). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).\n      @param {Object} [*value*]\n      @chainable\n  */\n  axisConfig(_) {\n    return arguments.length ? (this._axisConfig = Object.assign(this._axisConfig, _), this) : this._axisConfig;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current horizontal alignment.\n      @param {String} [*value* = \"center\"] Supports `\"left\"` and `\"center\"` and `\"right\"`.\n      @chainable\n  */\n  align(_) {\n    return arguments.length ? (this._align = _, this) : this._align;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Defines the color or colors to be used for the scale. If only a single color is given as a String, then the scale is interpolated by lightening that color. Otherwise, the function expects an Array of color values to be used in order for the scale.\n      @param {String|Array} [*value* = \"#0C8040\"]\n      @chainable\n  */\n  color(_) {\n    return arguments.length ? (this._color = _, this) : this._color;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape key will be drawn for each object in the array.\n      @param {Array} [*data* = []]\n      @chainable\n  */\n  data(_) {\n    return arguments.length ? (this._data = _, this) : this._data;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the transition duration of the ColorScale and returns the current class instance. If *value* is not specified, returns the current duration.\n      @param {Number} [*value* = 600]\n      @chainable\n  */\n  duration(_) {\n    return arguments.length ? (this._duration = _, this) : this._duration;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the overall height of the ColorScale and returns the current class instance. If *value* is not specified, returns the current height value.\n      @param {Number} [*value* = 100]\n      @chainable\n  */\n  height(_) {\n    return arguments.length ? (this._height = _, this) : this._height;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Sets the flow of the items inside the ColorScale. If no value is passed, the current flow will be returned.\n      @param {String} [*value* = \"bottom\"]\n      @chainable\n  */\n  orient(_) {\n    return arguments.length ? (this._orient = _, this) : this._orient;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the ColorScale content.\n      @example\n{\"width\": 180, \"height\": 24, \"x\": 10, \"y\": 20}\n  */\n  outerBounds() {\n    return this._outerBounds;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the padding between each key to the specified number and returns the current class instance. If *value* is not specified, returns the current padding value.\n      @param {Number} [*value* = 10]\n      @chainable\n  */\n  padding(_) {\n    return arguments.length ? (this._padding = _, this) : this._padding;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Rect](http://d3plus.org/docs/#Rect). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).\n      @param {Object} [*value*]\n      @chainable\n  */\n  rectConfig(_) {\n    return arguments.length ? (this._rectConfig = Object.assign(this._rectConfig, _), this) : this._rectConfig;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the scale of the ColorScale and returns the current class instance. If *value* is not specified, returns the current scale value.\n      @param {String} [*value* = \"linear\"] Can either be \"linear\", \"jenks\", or \"buckets\".\n      @chainable\n  */\n  scale(_) {\n    return arguments.length ? (this._scale = _, this) : this._scale;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.\n      @param {String|HTMLElement} [*selector* = d3.select(\"body\").append(\"svg\")]\n      @chainable\n  */\n  select(_) {\n    return arguments.length ? (this._select = select(_), this) : this._select;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The height of horizontal color scales, and width when positioned vertical.\n      @param {Number} [*value* = 10]\n      @chainable\n  */\n  size(_) {\n    return arguments.length ? (this._size = _, this) : this._size;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the value accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current value accessor.\n      @param {Function|String} [*value*]\n      @chainable\n      @example\nfunction value(d) {\n  return d.value;\n}\n  */\n  value(_) {\n    return arguments.length ? (this._value = typeof _ === \"function\" ? _ : constant(_), this) : this._value;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the overall width of the ColorScale and returns the current class instance. If *value* is not specified, returns the current width value.\n      @param {Number} [*value* = 400]\n      @chainable\n  */\n  width(_) {\n    return arguments.length ? (this._width = _, this) : this._width;\n  }\n\n}\n"],"names":["super","const","let","this"],"mappings":"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"}