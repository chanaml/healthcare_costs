{"version":3,"file":"d3plus-legend.js","sources":["../src/ckmeans.js","../src/ColorScale.js","../src/Legend.js"],"sourcesContent":["/**\n    @desc Sort an array of numbers by their numeric value, ensuring that the array is not changed in place.\n\nThis is necessary because the default behavior of .sort in JavaScript is to sort arrays as string values\n\n[1, 10, 12, 102, 20].sort()\n// output\n[1, 10, 102, 12, 20]\n\n    @param {Array<number>} array input array\n    @return {Array<number>} sorted array\n    @private\n    @example\nnumericSort([3, 2, 1]) // => [1, 2, 3]\n*/\nfunction numericSort(array) {\n  return array.slice().sort((a, b) => a - b);\n}\n\n/**\n    For a sorted input, counting the number of unique values is possible in constant time and constant memory. This is a simple implementation of the algorithm.\n\n    Values are compared with `===`, so objects and non-primitive objects are not handled in any special way.\n    @private\n    @param {Array} input an array of primitive values.\n    @returns {number} count of unique values\n    @example\nuniqueCountSorted([1, 2, 3]); // => 3\nuniqueCountSorted([1, 1, 1]); // => 1\n*/\nfunction uniqueCountSorted(input) {\n  let lastSeenValue, uniqueValueCount = 0;\n  for (let i = 0; i < input.length; i++) {\n    if (i === 0 || input[i] !== lastSeenValue) {\n      lastSeenValue = input[i];\n      uniqueValueCount++;\n    }\n  }\n  return uniqueValueCount;\n}\n\n/**\n    Create a new column x row matrix.\n    @private\n    @param {number} columns\n    @param {number} rows\n    @return {Array<Array<number>>} matrix\n    @example\nmakeMatrix(10, 10);\n*/\nfunction makeMatrix(columns, rows) {\n  const matrix = [];\n  for (let i = 0; i < columns; i++) {\n    const column = [];\n    for (let j = 0; j < rows; j++) column.push(0);\n    matrix.push(column);\n  }\n  return matrix;\n}\n\n/**\n    Generates incrementally computed values based on the sums and sums of squares for the data array\n    @private\n    @param {number} j\n    @param {number} i\n    @param {Array<number>} sums\n    @param {Array<number>} sumsOfSquares\n    @return {number}\n    @example\nssq(0, 1, [-1, 0, 2], [1, 1, 5]);\n*/\nfunction ssq(j, i, sums, sumsOfSquares) {\n  let sji; // s(j, i)\n\n  if (j > 0) {\n    const muji = (sums[i] - sums[j - 1]) / (i - j + 1); // mu(j, i)\n    sji = sumsOfSquares[i] - sumsOfSquares[j - 1] - (i - j + 1) * muji * muji;\n  }\n  else sji = sumsOfSquares[i] - sums[i] * sums[i] / (i + 1);\n\n  if (sji < 0) return 0;\n  return sji;\n}\n\n/**\n    Function that recursively divides and conquers computations for cluster j\n    @private\n    @param {number} iMin Minimum index in cluster to be computed\n    @param {number} iMax Maximum index in cluster to be computed\n    @param {number} cluster Index of the cluster currently being computed\n    @param {Array<Array<number>>} matrix\n    @param {Array<Array<number>>} backtrackMatrix\n    @param {Array<number>} sums\n    @param {Array<number>} sumsOfSquares\n*/\nfunction fillMatrixColumn(iMin, iMax, cluster, matrix, backtrackMatrix, sums, sumsOfSquares) {\n  if (iMin > iMax) return;\n\n  // Start at midpoint between iMin and iMax\n  const i = Math.floor((iMin + iMax) / 2);\n\n  matrix[cluster][i] = matrix[cluster - 1][i - 1];\n  backtrackMatrix[cluster][i] = i;\n\n  let jlow = cluster; // the lower end for j\n  if (iMin > cluster) jlow = Math.max(jlow, backtrackMatrix[cluster][iMin - 1] || 0);\n  jlow = Math.max(jlow, backtrackMatrix[cluster - 1][i] || 0);\n\n  let jhigh = i - 1; // the upper end for j\n  if (iMax < matrix.length - 1) jhigh = Math.min(jhigh, backtrackMatrix[cluster][iMax + 1] || 0);\n\n  for (let j = jhigh; j >= jlow; --j) {\n    const sji = ssq(j, i, sums, sumsOfSquares);\n\n    if (sji + matrix[cluster - 1][jlow - 1] >= matrix[cluster][i]) break;\n\n    // Examine the lower bound of the cluster border\n    const sjlowi = ssq(jlow, i, sums, sumsOfSquares);\n\n    const ssqjlow = sjlowi + matrix[cluster - 1][jlow - 1];\n\n    if (ssqjlow < matrix[cluster][i]) {\n      // Shrink the lower bound\n      matrix[cluster][i] = ssqjlow;\n      backtrackMatrix[cluster][i] = jlow;\n    }\n    jlow++;\n\n    const ssqj = sji + matrix[cluster - 1][j - 1];\n    if (ssqj < matrix[cluster][i]) {\n      matrix[cluster][i] = ssqj;\n      backtrackMatrix[cluster][i] = j;\n    }\n  }\n\n  fillMatrixColumn(iMin, i - 1, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);\n  fillMatrixColumn(i + 1, iMax, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);\n\n}\n\n/**\n    Initializes the main matrices used in Ckmeans and kicks off the divide and conquer cluster computation strategy\n    @private\n    @param {Array<number>} data sorted array of values\n    @param {Array<Array<number>>} matrix\n    @param {Array<Array<number>>} backtrackMatrix\n*/\nfunction fillMatrices(data, matrix, backtrackMatrix) {\n  const nValues = matrix[0].length;\n\n  // Shift values by the median to improve numeric stability\n  const shift = data[Math.floor(nValues / 2)];\n\n  // Cumulative sum and cumulative sum of squares for all values in data array\n  const sums = [];\n  const sumsOfSquares = [];\n\n  // Initialize first column in matrix & backtrackMatrix\n  for (let i = 0, shiftedValue; i < nValues; ++i) {\n    shiftedValue = data[i] - shift;\n    if (i === 0) {\n      sums.push(shiftedValue);\n      sumsOfSquares.push(shiftedValue * shiftedValue);\n    }\n    else {\n      sums.push(sums[i - 1] + shiftedValue);\n      sumsOfSquares.push(sumsOfSquares[i - 1] + shiftedValue * shiftedValue);\n    }\n\n    // Initialize for cluster = 0\n    matrix[0][i] = ssq(0, i, sums, sumsOfSquares);\n    backtrackMatrix[0][i] = 0;\n  }\n\n  // Initialize the rest of the columns\n  for (let cluster = 1; cluster < matrix.length; ++cluster) {\n    let iMin = nValues - 1;\n    if (cluster < matrix.length - 1) iMin = cluster;\n    fillMatrixColumn(iMin, nValues - 1, cluster, matrix, backtrackMatrix, sums, sumsOfSquares);\n  }\n}\n\n/**\n    @desc Ported to ES6 from the excellent [simple-statistics](https://github.com/simple-statistics/simple-statistics) packages.\n\nCkmeans clustering is an improvement on heuristic-based clustering approaches like Jenks. The algorithm was developed in [Haizhou Wang and Mingzhou Song](http://journal.r-project.org/archive/2011-2/RJournal_2011-2_Wang+Song.pdf) as a [dynamic programming](https://en.wikipedia.org/wiki/Dynamic_programming) approach to the problem of clustering numeric data into groups with the least within-group sum-of-squared-deviations.\n\nMinimizing the difference within groups - what Wang & Song refer to as `withinss`, or within sum-of-squares, means that groups are optimally homogenous within and the data is split into representative groups. This is very useful for visualization, where you may want to represent a continuous variable in discrete color or style groups. This function can provide groups that emphasize differences between data.\n\nBeing a dynamic approach, this algorithm is based on two matrices that store incrementally-computed values for squared deviations and backtracking indexes.\n\nThis implementation is based on Ckmeans 3.4.6, which introduced a new divide and conquer approach that improved runtime from O(kn^2) to O(kn log(n)).\n\nUnlike the [original implementation](https://cran.r-project.org/web/packages/Ckmeans.1d.dp/index.html), this implementation does not include any code to automatically determine the optimal number of clusters: this information needs to be explicitly provided.\n\n### References\n_Ckmeans.1d.dp: Optimal k-means Clustering in One Dimension by Dynamic\nProgramming_ Haizhou Wang and Mingzhou Song ISSN 2073-4859 from The R Journal Vol. 3/2, December 2011\n    @param {Array<number>} data input data, as an array of number values\n    @param {number} nClusters number of desired classes. This cannot be greater than the number of values in the data array.\n    @returns {Array<Array<number>>} clustered input\n    @example\nckmeans([-1, 2, -1, 2, 4, 5, 6, -1, 2, -1], 3);\n// The input, clustered into groups of similar numbers.\n//= [[-1, -1, -1, -1], [2, 2, 2], [4, 5, 6]]);\n*/\nexport default function(data, nClusters) {\n\n  if (nClusters > data.length) {\n    throw new Error(\"Cannot generate more classes than there are data values\");\n  }\n\n  const sorted = numericSort(data);\n\n  // we'll use this as the maximum number of clusters\n  const uniqueCount = uniqueCountSorted(sorted);\n\n  // if all of the input values are identical, there's one cluster with all of the input in it.\n  if (uniqueCount === 1) return [sorted];\n\n  const backtrackMatrix = makeMatrix(nClusters, sorted.length),\n        matrix = makeMatrix(nClusters, sorted.length);\n\n  // This is a dynamic programming way to solve the problem of minimizing within-cluster sum of squares. It's similar to linear regression in this way, and this calculation incrementally computes the sum of squares that are later read.\n  fillMatrices(sorted, matrix, backtrackMatrix);\n\n  // The real work of Ckmeans clustering happens in the matrix generation: the generated matrices encode all possible clustering combinations, and once they're generated we can solve for the best clustering groups very quickly.\n  let clusterRight = backtrackMatrix[0].length - 1;\n  const clusters = [];\n\n  // Backtrack the clusters from the dynamic programming matrix. This starts at the bottom-right corner of the matrix (if the top-left is 0, 0), and moves the cluster target with the loop.\n  for (let cluster = backtrackMatrix.length - 1; cluster >= 0; cluster--) {\n\n    const clusterLeft = backtrackMatrix[cluster][clusterRight];\n\n    // fill the cluster from the sorted input by taking a slice of the array. the backtrack matrix makes this easy - it stores the indexes where the cluster should start and end.\n    clusters[cluster] = sorted.slice(clusterLeft, clusterRight + 1);\n\n    if (cluster > 0) clusterRight = clusterLeft - 1;\n\n  }\n\n  return clusters;\n\n}\n","/**\n    @external BaseClass\n    @see https://github.com/d3plus/d3plus-common#BaseClass\n*/\n\nimport ckmeans from \"./ckmeans\";\n\nimport {extent, merge, range} from \"d3-array\";\nimport {interpolateHsl} from \"d3-interpolate\";\nimport {scaleLinear, scaleThreshold} from \"d3-scale\";\nimport {select} from \"d3-selection\";\n\nimport {Axis} from \"d3plus-axis\";\nimport {colorLighter} from \"d3plus-color\";\nimport {accessor, BaseClass, constant, elem} from \"d3plus-common\";\nimport {Rect} from \"d3plus-shape\";\n\n/**\n    @class ColorScale\n    @extends external:BaseClass\n    @desc Creates an SVG scale based on an array of data. If *data* is specified, immediately draws based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#shape.data) method.\n*/\nexport default class ColorScale extends BaseClass {\n\n  /**\n      @memberof ColorScale\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n\n    super();\n\n    this._axisClass = new Axis();\n    this._axisConfig = {\n      gridSize: 0\n    };\n    this._axisTest = new Axis();\n    this._align = \"middle\";\n    this._color = \"#0C8040\";\n    this._data = [];\n    this._duration = 600;\n    this._height = 200;\n    this._orient = \"bottom\";\n    this._outerBounds = {width: 0, height: 0, x: 0, y: 0};\n    this._padding = 5;\n    this._rectClass = new Rect();\n    this._rectConfig = {\n      stroke: \"#000\",\n      strokeWidth: 1\n    };\n    this._scale = \"linear\";\n    this._size = 10;\n    this._value = accessor(\"value\");\n    this._width = 400;\n\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Renders the current ColorScale to the page. If a *callback* is specified, it will be called once the ColorScale is done drawing.\n      @param {Function} [*callback* = undefined]\n      @chainable\n  */\n  render(callback) {\n\n    if (this._select === void 0) this.select(select(\"body\").append(\"svg\").attr(\"width\", `${this._width}px`).attr(\"height\", `${this._height}px`).node());\n\n    const horizontal = [\"bottom\", \"top\"].includes(this._orient);\n\n    const height = horizontal ? \"height\" : \"width\",\n          width = horizontal ? \"width\" : \"height\",\n          x = horizontal ? \"x\" : \"y\",\n          y = horizontal ? \"y\" : \"x\";\n\n    // Shape <g> Group\n    this._group = elem(\"g.d3plus-ColorScale\", {parent: this._select});\n\n    const domain = extent(this._data, this._value);\n    let colors = this._color, ticks;\n\n    if (!(colors instanceof Array)) {\n      colors = [\n        colorLighter(colors, 0.9),\n        colorLighter(colors, 0.75),\n        colorLighter(colors, 0.5),\n        colorLighter(colors, 0.25),\n        colors\n      ];\n    }\n\n    if (this._scale === \"jenks\") {\n\n      const data = this._data\n        .map(this._value)\n        .filter(d => d !== null && typeof d === \"number\");\n\n      if (data.length <= colors.length) {\n\n        const ts = scaleLinear()\n          .domain(range(0, data.length - 1))\n          .interpolate(interpolateHsl)\n          .range(colors);\n\n        colors = data.slice(0, data.length - 1).map((d, i) => ts(i));\n      }\n\n      const jenks = ckmeans(data, colors.length);\n\n      ticks = merge(jenks.map((c, i) => i === jenks.length - 1 ? [c[0], c[c.length - 1]] : [c[0]]));\n\n      this._colorScale = scaleThreshold()\n        .domain(ticks)\n        .range([\"black\"].concat(colors).concat(colors[colors.length - 1]));\n\n    }\n    else {\n\n      const step = (domain[1] - domain[0]) / (colors.length - 1);\n      const buckets = range(domain[0], domain[1] + step / 2, step);\n\n      if (this._scale === \"buckets\") ticks = buckets;\n\n      this._colorScale = scaleLinear()\n        .domain(buckets)\n        .range(colors);\n\n    }\n\n    const axisConfig = Object.assign({\n      domain: horizontal ? domain : domain.reverse(),\n      duration: this._duration,\n      height: this._height,\n      labels: ticks,\n      orient: this._orient,\n      padding: this._padding,\n      ticks,\n      width: this._width\n    }, this._axisConfig);\n\n    this._axisTest\n      .select(elem(\"g.d3plus-ColorScale-axisTest\", {enter: {opacity: 0}, parent: this._group}).node())\n      .config(axisConfig)\n      .render();\n\n    const axisBounds = this._axisTest.outerBounds();\n\n    this._outerBounds[width] = this[`_${width}`] - this._padding * 2;\n    this._outerBounds[height] = axisBounds[height] + this._size;\n\n    this._outerBounds[x] = this._padding;\n    this._outerBounds[y] = this._padding;\n    if (this._align === \"middle\") this._outerBounds[y] = (this[`_${height}`] - this._outerBounds[height]) / 2;\n    else if (this._align === \"end\") this._outerBounds[y] = this[`_${height}`] - this._padding - this._outerBounds[height];\n\n    const groupOffset = this._outerBounds[y] + ([\"bottom\", \"right\"].includes(this._orient) ? this._size : 0) - (axisConfig.padding || this._axisClass.padding());\n    this._axisClass\n      .select(elem(\"g.d3plus-ColorScale-axis\", {\n        parent: this._group,\n        update: {transform: `translate(${horizontal ? 0 : groupOffset}, ${horizontal ? groupOffset : 0})`}\n      }).node())\n      .config(axisConfig)\n      .align(\"start\")\n      .render();\n\n    const axisScale = this._axisTest._getPosition.bind(this._axisTest);\n    const scaleRange = this._axisTest._getRange();\n\n    let defs = this._group.selectAll(\"defs\").data([0]);\n    const defsEnter = defs.enter().append(\"defs\");\n    defsEnter.append(\"linearGradient\").attr(\"id\", `gradient-${this._uuid}`);\n    defs = defsEnter.merge(defs);\n    defs.select(\"linearGradient\")\n      .attr(`${x}1`, horizontal ? \"0%\" : \"100%\")\n      .attr(`${x}2`, horizontal ? \"100%\" : \"0%\")\n      .attr(`${y}1`, \"0%\")\n      .attr(`${y}2`, \"0%\");\n    const stops = defs.select(\"linearGradient\").selectAll(\"stop\")\n      .data(colors);\n    stops.enter().append(\"stop\").merge(stops)\n      .attr(\"offset\", (d, i) => `${i / (colors.length - 1) * 100}%`)\n      .attr(\"stop-color\", String);\n\n    function bucketWidth(d, i) {\n      const w = Math.abs(axisScale(ticks[i + 1]) - axisScale(d));\n      return w || 2;\n    }\n\n    this._rectClass\n      .data(ticks ? ticks.slice(0, ticks.length - 1) : [0])\n      .id((d, i) => i)\n      .select(elem(\"g.d3plus-ColorScale-Rect\", {parent: this._group}).node())\n      .config({\n        fill: ticks ? d => this._colorScale(d) : `url(#gradient-${this._uuid})`,\n        [x]: ticks ? (d, i) => axisScale(d) + bucketWidth(d, i) / 2 - ([\"left\", \"right\"].includes(this._orient) ? bucketWidth(d, i) : 0) : scaleRange[0] + (scaleRange[1] - scaleRange[0]) / 2,\n        [y]: this._outerBounds[y] + ([\"top\", \"left\"].includes(this._orient) ? axisBounds[height] : 0) + this._size / 2,\n        [width]: ticks ? bucketWidth : scaleRange[1] - scaleRange[0],\n        [height]: this._size\n      })\n      .config(this._rectConfig)\n      .render();\n\n    if (callback) setTimeout(callback, this._duration + 100);\n\n    return this;\n\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Axis](http://d3plus.org/docs/#Axis). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).\n      @param {Object} [*value*]\n      @chainable\n  */\n  axisConfig(_) {\n    return arguments.length ? (this._axisConfig = Object.assign(this._axisConfig, _), this) : this._axisConfig;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current horizontal alignment.\n      @param {String} [*value* = \"center\"] Supports `\"left\"` and `\"center\"` and `\"right\"`.\n      @chainable\n  */\n  align(_) {\n    return arguments.length ? (this._align = _, this) : this._align;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Defines the color or colors to be used for the scale. If only a single color is given as a String, then the scale is interpolated by lightening that color. Otherwise, the function expects an Array of color values to be used in order for the scale.\n      @param {String|Array} [*value* = \"#0C8040\"]\n      @chainable\n  */\n  color(_) {\n    return arguments.length ? (this._color = _, this) : this._color;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape key will be drawn for each object in the array.\n      @param {Array} [*data* = []]\n      @chainable\n  */\n  data(_) {\n    return arguments.length ? (this._data = _, this) : this._data;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the transition duration of the ColorScale and returns the current class instance. If *value* is not specified, returns the current duration.\n      @param {Number} [*value* = 600]\n      @chainable\n  */\n  duration(_) {\n    return arguments.length ? (this._duration = _, this) : this._duration;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the overall height of the ColorScale and returns the current class instance. If *value* is not specified, returns the current height value.\n      @param {Number} [*value* = 100]\n      @chainable\n  */\n  height(_) {\n    return arguments.length ? (this._height = _, this) : this._height;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc Sets the flow of the items inside the ColorScale. If no value is passed, the current flow will be returned.\n      @param {String} [*value* = \"bottom\"]\n      @chainable\n  */\n  orient(_) {\n    return arguments.length ? (this._orient = _, this) : this._orient;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the ColorScale content.\n      @example\n{\"width\": 180, \"height\": 24, \"x\": 10, \"y\": 20}\n  */\n  outerBounds() {\n    return this._outerBounds;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the padding between each key to the specified number and returns the current class instance. If *value* is not specified, returns the current padding value.\n      @param {Number} [*value* = 10]\n      @chainable\n  */\n  padding(_) {\n    return arguments.length ? (this._padding = _, this) : this._padding;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The [ColorScale](http://d3plus.org/docs/#ColorScale) is constructed by combining an [Axis](http://d3plus.org/docs/#Axis) for the ticks/labels and a [Rect](http://d3plus.org/docs/#Rect) for the actual color box (or multiple boxes, as in a jenks scale). Because of this, there are separate configs for the [Axis](http://d3plus.org/docs/#Axis) class used to display the text ([axisConfig](http://d3plus.org/docs/#ColorScale.axisConfig)) and the [Rect](http://d3plus.org/docs/#Rect) class used to draw the color breaks ([rectConfig](http://d3plus.org/docs/#ColorScale.rectConfig)). This method acts as a pass-through to the config method of the [Rect](http://d3plus.org/docs/#Rect). An example usage of this method can be seen [here](http://d3plus.org/examples/d3plus-legend/colorScale-dark/).\n      @param {Object} [*value*]\n      @chainable\n  */\n  rectConfig(_) {\n    return arguments.length ? (this._rectConfig = Object.assign(this._rectConfig, _), this) : this._rectConfig;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the scale of the ColorScale and returns the current class instance. If *value* is not specified, returns the current scale value.\n      @param {String} [*value* = \"linear\"] Can either be \"linear\", \"jenks\", or \"buckets\".\n      @chainable\n  */\n  scale(_) {\n    return arguments.length ? (this._scale = _, this) : this._scale;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.\n      @param {String|HTMLElement} [*selector* = d3.select(\"body\").append(\"svg\")]\n      @chainable\n  */\n  select(_) {\n    return arguments.length ? (this._select = select(_), this) : this._select;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc The height of horizontal color scales, and width when positioned vertical.\n      @param {Number} [*value* = 10]\n      @chainable\n  */\n  size(_) {\n    return arguments.length ? (this._size = _, this) : this._size;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the value accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current value accessor.\n      @param {Function|String} [*value*]\n      @chainable\n      @example\nfunction value(d) {\n  return d.value;\n}\n  */\n  value(_) {\n    return arguments.length ? (this._value = typeof _ === \"function\" ? _ : constant(_), this) : this._value;\n  }\n\n  /**\n      @memberof ColorScale\n      @desc If *value* is specified, sets the overall width of the ColorScale and returns the current class instance. If *value* is not specified, returns the current width value.\n      @param {Number} [*value* = 400]\n      @chainable\n  */\n  width(_) {\n    return arguments.length ? (this._width = _, this) : this._width;\n  }\n\n}\n","/**\n    @external BaseClass\n    @see https://github.com/d3plus/d3plus-common#BaseClass\n*/\n\nimport {max, sum} from \"d3-array\";\nimport {select} from \"d3-selection\";\n\nimport {accessor, assign, BaseClass, configPrep, constant, elem} from \"d3plus-common\";\nimport * as shapes from \"d3plus-shape\";\nimport {TextBox, textWidth, textWrap} from \"d3plus-text\";\n\n/**\n    @class Legend\n    @extends external:BaseClass\n    @desc Creates an SVG scale based on an array of data. If *data* is specified, immediately draws based on the specified array and returns the current class instance. If *data* is not specified on instantiation, it can be passed/updated after instantiation using the [data](#shape.data) method.\n*/\nexport default class Legend extends BaseClass {\n\n  /**\n      @memberof Legend\n      @desc Invoked when creating a new class instance, and sets any default parameters.\n      @private\n  */\n  constructor() {\n\n    super();\n\n    this._align = \"center\";\n    this._data = [];\n    this._direction = \"row\";\n    this._duration = 600;\n    this._height = 200;\n    this._id = accessor(\"id\");\n    this._label = accessor(\"id\");\n    this._lineData = [];\n    this._outerBounds = {width: 0, height: 0, x: 0, y: 0};\n    this._padding = 5;\n    this._shape = constant(\"Rect\");\n    this._shapes = [];\n    this._shapeConfig = {\n      duration: this._duration,\n      fill: accessor(\"color\"),\n      height: constant(10),\n      hitArea: (dd, i) => {\n        const d = this._lineData[i],\n              h = max([d.height, d.shapeHeight]);\n        return {width: d.width + d.shapeWidth, height: h, x: -d.shapeWidth / 2, y: -h / 2};\n      },\n      labelBounds: (dd, i, s) => {\n        const d = this._lineData[i],\n              w = s.r !== void 0 ? s.r : s.width / 2;\n        return {width: d.width, height: d.height, x: w + this._padding, y: -d.height / 2 + (d.lh - d.s) / 2 + 1};\n      },\n      labelConfig: {\n        fontColor: constant(\"#444\"),\n        fontFamily: new TextBox().fontFamily(),\n        fontResize: false,\n        fontSize: constant(10)\n      },\n      opacity: 1,\n      r: constant(5),\n      width: constant(10),\n      x: (d, i) => {\n        const datum = this._lineData[i];\n        const y = datum.y;\n        const pad = this._align === \"left\" || this._align === \"right\" && this._direction === \"column\" ? 0 : this._align === \"center\"\n          ? (this._outerBounds.width - this._rowWidth(this._lineData.filter(l => y === l.y))) / 2\n          : this._outerBounds.width - this._rowWidth(this._lineData.filter(l => y === l.y));\n        const prevWords = this._lineData.slice(0, i).filter(l => y === l.y);\n        return this._rowWidth(prevWords) + this._padding * (prevWords.length ? datum.sentence ? 2 : 1 : 0) +\n               this._outerBounds.x + datum.shapeWidth / 2 + pad;\n      },\n      y: (d, i) => {\n        const ld = this._lineData[i];\n        return ld.y + this._titleHeight + this._outerBounds.y +\n               max(this._lineData.filter(l => ld.y === l.y).map(l => l.height).concat(this._data.map((l, x) => this._fetchConfig(\"height\", l, x)))) / 2;\n      }\n    };\n    this._titleClass = new TextBox();\n    this._titleConfig = {};\n    this._verticalAlign = \"middle\";\n    this._width = 400;\n\n  }\n\n  _fetchConfig(key, d, i) {\n    const val = this._shapeConfig[key] || this._shapeConfig.labelConfig[key];\n    if (!val && key === \"lineHeight\") return this._fetchConfig(\"fontSize\", d, i) * 1.4;\n    return typeof val === \"function\" ? val(d, i) : val;\n  }\n\n  _rowHeight(row) {\n    return max(row.map(d => d.height).concat(row.map(d => d.shapeHeight))) + this._padding;\n  }\n\n  _rowWidth(row) {\n    return sum(row.map((d, i) => {\n      const p = this._padding * (i === row.length - 1 ? 0 : d.width ? 2 : 1);\n      return d.shapeWidth + d.width + p;\n    }));\n  }\n\n  /**\n      @memberof Legend\n      @desc Renders the current Legend to the page. If a *callback* is specified, it will be called once the legend is done drawing.\n      @param {Function} [*callback* = undefined]\n      @chainable\n  */\n  render(callback) {\n\n    if (this._select === void 0) this.select(select(\"body\").append(\"svg\").attr(\"width\", `${this._width}px`).attr(\"height\", `${this._height}px`).node());\n\n    // Shape <g> Group\n    this._group = elem(\"g.d3plus-Legend\", {parent: this._select});\n\n    let availableHeight = this._height;\n    this._titleHeight = 0;\n    if (this._title) {\n\n      const f = this._titleConfig.fontFamily || this._titleClass.fontFamily()(),\n            s = this._titleConfig.fontSize || this._titleClass.fontSize()();\n      let lH = lH = this._titleConfig.lineHeight || this._titleClass.lineHeight();\n      lH = lH ? lH() : s * 1.4;\n\n      const res = textWrap()\n        .fontFamily(f)\n        .fontSize(s)\n        .lineHeight(lH)\n        .width(this._width)\n        .height(this._height)\n        (this._title);\n      this._titleHeight = lH + res.lines.length + this._padding;\n      availableHeight -= this._titleHeight;\n    }\n\n    // Calculate Text Sizes\n    this._lineData = this._data.map((d, i) => {\n\n      const label = this._label(d, i);\n\n      let res = {\n        data: d,\n        i,\n        id: this._id(d, i),\n        shapeWidth: this._fetchConfig(\"width\", d, i),\n        shapeHeight: this._fetchConfig(\"height\", d, i),\n        y: 0\n      };\n\n      if (!label) {\n        res.sentence = false;\n        res.words = [];\n        res.height = 0;\n        res.width = 0;\n        return res;\n      }\n\n      const f = this._fetchConfig(\"fontFamily\", d, i),\n            lh = this._fetchConfig(\"lineHeight\", d, i),\n            s = this._fetchConfig(\"fontSize\", d, i);\n\n      const h = availableHeight - (this._data.length + 1) * this._padding,\n            w = this._width;\n\n      res = Object.assign(res, textWrap()\n        .fontFamily(f)\n        .fontSize(s)\n        .lineHeight(lh)\n        .width(w)\n        .height(h)\n        (label));\n\n      res.width = Math.ceil(max(res.lines.map(t => textWidth(t, {\"font-family\": f, \"font-size\": s})))) + s * 0.75;\n      res.height = Math.ceil(res.lines.length * (lh + 1));\n      res.og = {height: res.height, width: res.width};\n      res.f = f;\n      res.s = s;\n      res.lh = lh;\n\n      return res;\n\n    });\n\n    let spaceNeeded;\n    const availableWidth = this._width - this._padding * 2;\n    spaceNeeded = this._rowWidth(this._lineData);\n\n    if (this._direction === \"column\" || spaceNeeded > availableWidth) {\n      let lines = 1, newRows = [];\n\n      const maxLines = max(this._lineData.map(d => d.words.length));\n      this._wrapLines = function() {\n\n        lines++;\n\n        if (lines > maxLines) return;\n\n        const wrappable = lines === 1 ? this._lineData.slice()\n          : this._lineData.filter(d => d.width + d.shapeWidth + this._padding * (d.width ? 2 : 1) > availableWidth && d.words.length >= lines)\n              .sort((a, b) => b.sentence.length - a.sentence.length);\n\n        if (wrappable.length && availableHeight > wrappable[0].height * lines) {\n\n          let truncated = false;\n          for (let x = 0; x < wrappable.length; x++) {\n            const label = wrappable[x];\n            const h = label.og.height * lines, w = label.og.width * (1.5 * (1 / lines));\n            const res = textWrap().fontFamily(label.f).fontSize(label.s).lineHeight(label.lh).width(w).height(h)(label.sentence);\n            if (!res.truncated) {\n              label.width = Math.ceil(max(res.lines.map(t => textWidth(t, {\"font-family\": label.f, \"font-size\": label.s})))) + label.s;\n              label.height = res.lines.length * (label.lh + 1);\n            }\n            else {\n              truncated = true;\n              break;\n            }\n          }\n          if (!truncated) this._wrapRows();\n        }\n        else {\n          newRows = [];\n          return;\n        }\n\n      };\n\n      this._wrapRows = function() {\n        newRows = [];\n        let row = 1, rowWidth = 0;\n        for (let i = 0; i < this._lineData.length; i++) {\n          const d = this._lineData[i],\n                w = d.width + this._padding * (d.width ? 2 : 1) + d.shapeWidth;\n          if (sum(newRows.map(row => max(row, d => max([d.height, d.shapeHeight])))) > availableHeight) {\n            newRows = [];\n            break;\n          }\n          if (w > availableWidth) {\n            newRows = [];\n            this._wrapLines();\n            break;\n          }\n          else if (rowWidth + w < availableWidth) {\n            rowWidth += w;\n          }\n          else if (this._direction !== \"column\") {\n            rowWidth = w;\n            row++;\n          }\n          if (!newRows[row - 1]) newRows[row - 1] = [];\n          newRows[row - 1].push(d);\n          if (this._direction === \"column\") {\n            rowWidth = 0;\n            row++;\n          }\n        }\n      };\n\n      this._wrapRows();\n\n      if (!newRows.length || sum(newRows, this._rowHeight.bind(this)) + this._padding > availableHeight) {\n        spaceNeeded = sum(this._lineData.map(d => d.shapeWidth + this._padding)) - this._padding;\n        for (let i = 0; i < this._lineData.length; i++) {\n          this._lineData[i].width = 0;\n          this._lineData[i].height = 0;\n        }\n        this._wrapRows();\n      }\n\n      if (newRows.length && sum(newRows, this._rowHeight.bind(this)) + this._padding < availableHeight) {\n        newRows.forEach((row, i) => {\n          row.forEach(d => {\n            if (i) {\n              d.y = sum(newRows.slice(0, i), this._rowHeight.bind(this));\n            }\n          });\n        });\n        spaceNeeded = max(newRows, this._rowWidth.bind(this));\n      }\n    }\n\n    const innerHeight = max(this._lineData, (d, i) => max([d.height, this._fetchConfig(\"height\", d.data, i)]) + d.y) + this._titleHeight,\n          innerWidth = spaceNeeded;\n\n    this._outerBounds.width = innerWidth;\n    this._outerBounds.height = innerHeight;\n\n    let xOffset = this._padding,\n        yOffset = this._padding;\n    if (this._align === \"center\") xOffset = (this._width - innerWidth) / 2;\n    else if (this._align === \"right\") xOffset = this._width - this._padding - innerWidth;\n    if (this._verticalAlign === \"middle\") yOffset = (this._height - innerHeight) / 2;\n    else if (this._verticalAlign === \"bottom\") yOffset = this._height - this._padding - innerHeight;\n    this._outerBounds.x = xOffset;\n    this._outerBounds.y = yOffset;\n\n    this._titleClass\n      .data(this._title ? [{text: this._title}] : [])\n      .duration(this._duration)\n      .select(this._group.node())\n      .textAnchor({left: \"start\", center: \"middle\", right: \"end\"}[this._align])\n      .width(this._width - this._padding * 2)\n      .x(this._padding)\n      .y(this._outerBounds.y)\n      .config(this._titleConfig)\n      .render();\n\n    this._shapes = [];\n    const baseConfig = configPrep.bind(this)(this._shapeConfig, \"legend\"),\n          config = {\n            id: d => d.id,\n            label: d => d.label,\n            lineHeight: d => d.lH\n          };\n\n    const data = this._data.map((d, i) => {\n\n      const obj = {\n        __d3plus__: true,\n        data: d, i,\n        id: this._id(d, i),\n        label: this._lineData[i].width ? this._label(d, i) : false,\n        lH: this._fetchConfig(\"lineHeight\", d, i),\n        shape: this._shape(d, i)\n      };\n\n      return obj;\n\n    });\n\n    // Legend Shapes\n    this._shapes = [];\n    [\"Circle\", \"Rect\"].forEach(Shape => {\n\n      this._shapes.push(new shapes[Shape]()\n        .data(data.filter(d => d.shape === Shape))\n        .duration(this._duration)\n        .labelPadding(0)\n        .select(this._group.node())\n        .verticalAlign(\"top\")\n        .config(assign({}, baseConfig, config))\n        .render());\n\n    });\n\n    if (callback) setTimeout(callback, this._duration + 100);\n\n    return this;\n\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the active method for all shapes to the specified function and returns the current class instance. If *value* is not specified, returns the current active method.\n      @param {Function} [*value*]\n      @chainable\n  */\n  active(_) {\n    this._shapes.forEach(s => s.active(_));\n    return this;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the horizontal alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current horizontal alignment.\n      @param {String} [*value* = \"center\"] Supports `\"left\"` and `\"center\"` and `\"right\"`.\n      @chainable\n  */\n  align(_) {\n    return arguments.length ? (this._align = _, this) : this._align;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *data* is specified, sets the data array to the specified array and returns the current class instance. If *data* is not specified, returns the current data array. A shape key will be drawn for each object in the array.\n      @param {Array} [*data* = []]\n      @chainable\n  */\n  data(_) {\n    return arguments.length ? (this._data = _, this) : this._data;\n  }\n\n  /**\n      @memberof Legend\n      @desc Sets the flow of the items inside the legend. If no value is passed, the current flow will be returned.\n      @param {String} [*value* = \"row\"]\n      @chainable\n  */\n  direction(_) {\n    return arguments.length ? (this._direction = _, this) : this._direction;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the transition duration of the legend and returns the current class instance. If *value* is not specified, returns the current duration.\n      @param {Number} [*value* = 600]\n      @chainable\n  */\n  duration(_) {\n    return arguments.length ? (this._duration = _, this) : this._duration;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the overall height of the legend and returns the current class instance. If *value* is not specified, returns the current height value.\n      @param {Number} [*value* = 100]\n      @chainable\n  */\n  height(_) {\n    return arguments.length ? (this._height = _, this) : this._height;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the hover method for all shapes to the specified function and returns the current class instance. If *value* is not specified, returns the current hover method.\n      @param {Function} [*value*]\n      @chainable\n  */\n  hover(_) {\n    this._shapes.forEach(s => s.hover(_));\n    return this;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the id accessor to the specified function and returns the current class instance. If *value* is not specified, returns the current id accessor.\n      @param {Function} [*value*]\n      @chainable\n      @example\nfunction value(d) {\n  return d.id;\n}\n  */\n  id(_) {\n    return arguments.length ? (this._id = _, this) : this._id;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the label accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current label accessor, which is the [id](#shape.id) accessor by default.\n      @param {Function|String} [*value*]\n      @chainable\n  */\n  label(_) {\n    return arguments.length ? (this._label = typeof _ === \"function\" ? _ : constant(_), this) : this._label;\n  }\n\n  /**\n      @memberof Legend\n      @desc If called after the elements have been drawn to DOM, will returns the outer bounds of the legend content.\n      @example\n{\"width\": 180, \"height\": 24, \"x\": 10, \"y\": 20}\n  */\n  outerBounds() {\n    return this._outerBounds;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the padding between each key to the specified number and returns the current class instance. If *value* is not specified, returns the current padding value.\n      @param {Number} [*value* = 10]\n      @chainable\n  */\n  padding(_) {\n    return arguments.length ? (this._padding = _, this) : this._padding;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *selector* is specified, sets the SVG container element to the specified d3 selector or DOM element and returns the current class instance. If *selector* is not specified, returns the current SVG container element.\n      @param {String|HTMLElement} [*selector* = d3.select(\"body\").append(\"svg\")]\n      @chainable\n  */\n  select(_) {\n    return arguments.length ? (this._select = select(_), this) : this._select;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the shape accessor to the specified function or string and returns the current class instance. If *value* is not specified, returns the current shape accessor.\n      @param {Function|String} [*value* = \"Rect\"]\n      @chainable\n  */\n  shape(_) {\n    return arguments.length ? (this._shape = typeof _ === \"function\" ? _ : constant(_), this) : this._shape;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *config* is specified, sets the methods that correspond to the key/value pairs for each shape and returns the current class instance. If *config* is not specified, returns the current shape configuration.\n      @param {Object} [*config* = {}]\n      @chainable\n  */\n  shapeConfig(_) {\n    return arguments.length ? (this._shapeConfig = assign(this._shapeConfig, _), this) : this._shapeConfig;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the title of the legend and returns the current class instance. If *value* is not specified, returns the current title.\n      @param {String} [*value*]\n      @chainable\n  */\n  title(_) {\n    return arguments.length ? (this._title = _, this) : this._title;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the title configuration of the legend and returns the current class instance. If *value* is not specified, returns the current title configuration.\n      @param {Object} [*value*]\n      @chainable\n  */\n  titleConfig(_) {\n    return arguments.length ? (this._titleConfig = assign(this._titleConfig, _), this) : this._titleConfig;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the vertical alignment to the specified value and returns the current class instance. If *value* is not specified, returns the current vertical alignment.\n      @param {String} [*value* = \"middle\"] Supports `\"top\"` and `\"middle\"` and `\"bottom\"`.\n      @chainable\n  */\n  verticalAlign(_) {\n    return arguments.length ? (this._verticalAlign = _, this) : this._verticalAlign;\n  }\n\n  /**\n      @memberof Legend\n      @desc If *value* is specified, sets the overall width of the legend and returns the current class instance. If *value* is not specified, returns the current width value.\n      @param {Number} [*value* = 400]\n      @chainable\n  */\n  width(_) {\n    return arguments.length ? (this._width = _, this) : this._width;\n  }\n\n}\n"],"names":["let","const","super","Axis","Rect","accessor","select","elem","extent","colorLighter","scaleLinear","range","interpolateHsl","merge","scaleThreshold","this","constant","BaseClass","max","TextBox","sum","textWrap","textWidth","x","configPrep","assign"],"mappings":"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"}